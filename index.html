<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>·àõ·à≠·ä≠ ·àä·àµ·âµ ·àÖ·çÉ·äì·âµ ·àà</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
    
    <script>
        // Global variables
        let students = [];
        let departments = [];
        let searchQuery = '';
        let isSearching = false;

        // Predefined student names
        const predefinedStudents = [
           {"name": "·àÄ·à¥·âµ ·å•·àã·àÅ·äï", "gender": "female"},
    {"name": "·àÄ·â•·â≥·àô ·à≤·à≥·ã≠", "gender": "male"},
    {"name": "·àÄ·ã≠·àò·âµ ·ä†·â•·à≠·àÉ·àù", "gender": "female"},
    {"name": "·àÄ·äì ·â¥·ãé·ãµ·àÆ·àµ", "gender": "female"},
    {"name": "·àÖ·àä·äì ·ä†·à≥·àù·äê·ãç", "gender": "female"},
    {"name": "·àÖ·ã≠·ãà·âµ ·àò·â≥·åà·àµ", "gender": "female"},
    {"name": "·àò·ä≠·àä·âµ ·àô·àâ·ãì·àà·àù", "gender": "female"},
    {"name": "·àò·ä≠·àä·âµ ·ã≠·ãµ·äê·âÉ·â∏·ãç", "gender": "female"},
    {"name": "·àò·ä≠·àä·âµ ·ä†·àµ·çã·ãç", "gender": "female"},
    {"name": "·àö·ä™·ã´·àµ ·ãã·àà", "gender": "male"},
    {"name": "·àõ·à≠·ä´·äï ·ãÆ·äì·àµ", "gender": "female"},
    {"name": "·àõ·à≠·äÆ·äï ·ã∞·à®·åÄ", "gender": "male"},
    {"name": "·àõ·ä≠·â§·àç ·â¢·àç·àç·äù", "gender": "male"},
    {"name": "·àú·àã·âµ ·ãà·äï·ã∂·à∞·äï", "gender": "female"},
    {"name": "·àú·à´·ä≠·àç ·ãò·äê·â†", "gender": "female"},
    {"name": "·àù·ãï·à´·åç ·çÉ·ãµ·âÅ", "gender": "male"},
    {"name": "·à´·ä¨·â• ·ä†·àà·àõ·ã®·àÅ", "gender": "female"},
    {"name": "·à∞·àã·àõ·ãä·âµ ·ãò·àà·âÄ", "gender": "female"},
    {"name": "·à∞·àã·àù ·çç·âÉ·ã±", "gender": "female"},
    {"name": "·à∞·àò·àÄ·àç ·â∞·ä≠·àä·âµ", "gender": "female"},
    {"name": "·à≥·àô·ä§·àç ·àù·âµ·ä©", "gender": "male"},
    {"name": "·à≥·àô·ä§·àç ·ä†·àµ·â≥·ãç·àµ", "gender": "male"},
    {"name": "·à≥·àù·à´·ãä·âµ ·àô·àâ·åå·â≥", "gender": "female"},
    {"name": "·à≥·àÆ·äï ·ä†·à∏·äì·çä", "gender": "female"},
    {"name": "·à≥·àù·à∂·äï ·â∞·àæ·àò", "gender": "male"},
    {"name": "·âÉ·àà·ä†·â• ·åà·â•·à® ·çÉ·ãµ·âÖ", "gender": "male"},
    {"name": "·âÉ·àç·ä™·ã≥·äï ·ãò·àò·ã¥", "gender": "female"},
    {"name": "·âÖ·ã±·àµ ·ä†·àµ·âª·àà·ãç", "gender": "male"},
    {"name": "·âÖ·ãµ·àµ·âµ ·â∞·àæ·àò", "gender": "female"},
    {"name": "·â†·à®·ä®·âµ ·â∞·àµ·çã·ã¨", "gender": "male"},
    {"name": "·â†·à®·ä®·âµ ·ä®·â†·ã∞", "gender": "male"},
    {"name": "·â†·ä•·àù·äê·âµ ·àò·äï·åç·à•·â±", "gender": "female"},
    {"name": "·â†·ä•·àù·äê·âµ ·ã∞·à®·åÄ", "gender": "female"},
    {"name": "·â†·çÄ·àé·âµ ·ã∞·à®·åÄ", "gender": "female"},
    {"name": "·â¢·â≥·äï·ã´ ·ã´·à¨·ãµ", "gender": "female"},
    {"name": "·â¢·äí·ã´·àù ·â≥·ã∞·à∞", "gender": "male"},
    {"name": "·â£·à≠·äÆ·äï ·äñ·â§·àç", "gender": "male"},
    {"name": "·â§·â∞·àç ·ã≥·äï·ä§·àç", "gender": "female"},
    {"name": "·â§·âµ·àú·àé·äï ·çç·âÖ·à©", "gender": "female"},
    {"name": "·â•·à©·ä≠ ·àµ·àà·à∫", "gender": "male"},
    {"name": "·âµ·ãù·â≥ ·àµ·ä≥·à¨", "gender": "female"},
    {"name": "·äì·à≠·ã∂·àµ ·àò·àà·à∞", "gender": "female"},
    {"name": "·äì·à≠·ã∂·àµ ·ä†·àà·àõ·ã®·àÅ", "gender": "female"},
    {"name": "·äì·ä¶·ãµ ·ä™·àÆ·àµ", "gender": "male"},
    {"name": "·äñ·àÄ·àö·äï ·ä†·ã≥·äê", "gender": "female"},
    {"name": "·ä†·àç·ä†·ãõ·à≠ ·ä†·àà·àù·à∞·åà·ãµ", "gender": "male"},
    {"name": "·ä†·àõ·äë·ä§·àç ·ä†·åç·ãò·ãç", "gender": "male"},
    {"name": "·ä†·àú·äï ·àô·àã·âµ", "gender": "male"},
    {"name": "·ä†·àú·äï ·ä†·â•·ã≤", "gender": "male"},
    {"name": "·ä†·à≠·à¥·àõ ·â†·àã·ã≠·äê·àÖ", "gender": "female"},
    {"name": "·ä†·à≠·à¥·àõ ·ã´·à¨·ãµ", "gender": "female"},
    {"name": "·ä†·à≠·à¥·àõ ·ãà·äï·ã±", "gender": "female"},
    {"name": "·ä†·à≠·à¥·àõ ·çã·äï·â≥·àÅ·äï", "gender": "female"},
    {"name": "·ä†·à≠·à¥·àõ·ãä·âµ ·à≥·àÖ·àà", "gender": "female"},
    {"name": "·ä†·â¢·åä·ã´ ·â†·àã·ã≠", "gender": "female"},
    {"name": "·ä†·â§·àù ·ã≠·à≠·åã·àà·àù", "gender": "male"},
    {"name": "·ä†·â§·äê·ãò·à≠ ·ä†·à∞·çã", "gender": "male"},
    {"name": "·ä†·â•·à≥·àã·âµ ·à≥·àÖ·àà ·àõ·à≠·ã´·àù", "gender": "female"},
    {"name": "·ä†·â•·à≥·àã·âµ ·ã∞·à≥·àà·äù", "gender": "female"},
    {"name": "·ä†·ä™·ã´ ·ä†·àµ·à´·âµ", "gender": "male"},
    {"name": "·ä†·ãõ·à≠·ä§·àç ·ä†·â†·â†", "gender": "male"},
    {"name": "·ä§·ã±·ä§·àç ·ä†·àõ·à®", "gender": "female"},
    {"name": "·ä•·ã´·à± ·ä•·äï·ã≥·àç·ä´·â∏·ãç", "gender": "male"},
    {"name": "·ä•·ãÆ·â• ·ä®·â∞·àõ", "gender": "male"},
    {"name": "·ä•·ãÆ·ä†·â• ·ã≠·à≠·åã·àà·àù", "gender": "male"},
    {"name": "·ä•·ãµ·àã·ãä·âµ ·ä†·àà·àù·ä•·à∏·âµ", "gender": "female"},
    {"name": "·ä™·à©·â§·àç ·ä†·àµ·à´·âµ", "gender": "male"},
    {"name": "·ä´·àå·â• ·àö·ä™·ã´·àµ", "gender": "male"},
    {"name": "·ä¨·â•·àÆ·äï ·à∞·ã≠·çâ", "gender": "female"},
    {"name": "·ä¨·äì ·â∞·àµ·çã·ã¨", "gender": "male"},
    {"name": "·ä≠·à≠·àµ·â≤·ã´·äï ·â∞·åà·äù", "gender": "female"},
    {"name": "·ã®·àö·ä´·ä§·àç ·ä†·â†·â†", "gender": "male"},
    {"name": "·ã®·ä†·â•·à•·à´ ·â¥·ãé·ãµ·àÆ·àµ", "gender": "female"},
    {"name": "·ã®·ä†·â•·àµ·à´ ·ä†·â£·ã≠", "gender": "female"},
    {"name": "·ã®·ä†·â•·àµ·à´ ·ãò·à≠·åã·ãç", "gender": "male"},
    {"name": "·ã´·äî·âµ ·â≥·à™·ä©", "gender": "female"},
    {"name": "·ãÆ·àê·äï·àµ ·àà·åà·à∞", "gender": "male"},
    {"name": "·ãÆ·àê·äï·àµ ·ã∞·à≥·àà·äù", "gender": "male"},
    {"name": "·ãÆ·à≠·ã≥·äñ·àµ ·â≥·ã∞·à∞", "gender": "female"},
    {"name": "·ã≥·åç·àù ·àù·àµ·åã·äì", "gender": "male"},
    {"name": "·åà·àä·àã ·àà·ã≠·ä©·äï", "gender": "female"},
    {"name": "·åà·àã·äï ·â∞·àæ·àò", "gender": "female"},
    {"name": "·çÖ·ãÆ·äï ·ä†·àµ·à´·âµ", "gender": "female"},
    {"name": "·çÖ·ãÆ·äï ·çà·âÄ·à®·äù", "gender": "female"},
    {"name": "·çÖ·äì·âµ ·â†·àã·â∏·ãç", "gender": "female"},
    {"name": "·çå·äî·âµ ·ãà·äï·ã±", "gender": "female"},
    {"name": "·çç·à¨·àÖ·ã≠·ãà·âµ ·â¢·â∞·ãç", "gender": "female"},
    {"name": "·çç·âÖ·à®·ä†·â• ·ã∞·à≥·àà·äù", "gender": "male"}
        ];

        // Initialize the application
        function initializeApp() {
            loadFromLocalStorage();
            
            // Automatically add predefined students if no students exist
            if (students.length === 0 && predefinedStudents.length > 0) {
                addMultipleStudents(predefinedStudents);
                showMessage(`${predefinedStudents.length} ·â∞·àõ·à™·ãé·âΩ ·â†·â∞·à≥·ä´ ·àÅ·äî·â≥ ·â∞·å®·àù·à®·ãã·àç!`, 'success');
            }
            
            initializeSearch();
            renderLeaderboard();
            renderConfigView();
            updateStudentStats();
        }

        // Local Storage Functions
        function loadFromLocalStorage() {
            // Load departments
            const savedDepartments = localStorage.getItem('departments');
            if (savedDepartments) {
                departments = JSON.parse(savedDepartments);
            } else {
                // Default departments
                departments = [
                    { id: '1', name: '·ã®·àò·çÖ·àÄ·çç ·âÖ·ã±·àµ ·å•·äì·âµ' },
                    { id: '2', name: '·ã® ·â§·â∞·ä≠·à≠·àµ·â≤·ã´·äï ·â≥·à™·ä≠' },
                    { id: '3', name: '·åç·ãï·ãù' },
                    { id: '4', name: '·à•·à®·ãì·â∞ ·â§·â∞·ä≠·à≠·àµ·â≤·ã´·äï' },
                    { id: '5', name: '·ä≠·à≠·àµ·â≤·ã´·äì·ãä ·à•·äê ·ùÖ·åç·â£·à≠' },
                    { id: '6', name: '·àò·à∞·à®·â∞ ·àÄ·ã≠·àõ·äñ·âµ' }
                ];
                localStorage.setItem('departments', JSON.stringify(departments));
            }

            // Load students
            const savedStudents = localStorage.getItem('students');
            if (savedStudents) {
                students = JSON.parse(savedStudents);
            } else {
                students = [];
                localStorage.setItem('students', JSON.stringify([]));
            }
        }

        function saveToLocalStorage() {
            localStorage.setItem('students', JSON.stringify(students));
            localStorage.setItem('departments', JSON.stringify(departments));
            updateStudentStats();
        }

        // Update student statistics
        function updateStudentStats() {
            const totalStudents = students.length;
            const maleCount = students.filter(s => s.gender === 'male').length;
            const femaleCount = students.filter(s => s.gender === 'female').length;
            
            // Calculate pass/fail/not study statistics
            let passCount = 0;
            let failCount = 0;
            let notStudyCount = 0;
            
            students.forEach(student => {
                let totalScore = 0;
                let hasAnyScore = false;
                let allZero = true;
                
                departments.forEach(dept => {
                    const score = student.scores[dept.id];
                    if (score !== undefined) {
                        hasAnyScore = true;
                        if (score > 0) {
                            allZero = false;
                        }
                        totalScore += score;
                    }
                });
                
                if (!hasAnyScore) {
                    notStudyCount++;
                } else if (allZero) {
                    notStudyCount++;
                } else {
                    const average = totalScore / departments.length;
                    if (average >= 50) {
                        passCount++;
                    } else {
                        failCount++;
                    }
                }
            });
            
            // Update the info card
            const statsContainer = document.getElementById('student-stats-container');
            if (statsContainer) {
                statsContainer.innerHTML = `
                    <div class="space-y-3">
                        <div class="flex justify-between items-center">
                            <span class="text-gray-600">·å†·âÖ·àã·àã ·â∞·àõ·à™·ãé·âΩ</span>
                            <span class="text-xl font-bold text-blue-600">${totalStudents}</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-600">·ãà·äï·ã∂·âΩ</span>
                            <span class="text-lg font-semibold text-blue-500">${maleCount}</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-600">·à¥·â∂·âΩ</span>
                            <span class="text-lg font-semibold text-pink-500">${femaleCount}</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-600">·ã´·àà·çà</span>
                            <span class="text-lg font-semibold text-green-500">${passCount}</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-600">·ã®·ãà·ã∞·âÖ</span>
                            <span class="text-lg font-semibold text-red-500">${failCount}</span>
                        </div>
                        <div class="flex justify-between items-center">
                            <span class="text-gray-600">·àù·äï·àù ·ä†·àç·â∞·àõ·à®·àù</span>
                            <span class="text-lg font-semibold text-gray-500">${notStudyCount}</span>
                        </div>
                    </div>
                    <div class="mt-6 pt-6 border-t border-gray-200">
                        <p class="text-sm text-gray-500 text-center">
                            32 ·â∞·àõ·à™·ãé·âΩ ·â†·à´·àµ·à∞·à≠ ·â∞·å®·àù·à®·ãã·àç
                        </p>
                    </div>
                `;
            }
            
            updateSearchResultsCount();
        }

        // Search Functions
        function initializeSearch() {
            const leaderboardContainer = document.getElementById('leaderboard-container');
            const searchHTML = `
                <div class="mb-4">
                    <div class="flex flex-col sm:flex-row gap-4 items-center">
                        <div class="flex-1 relative">
                            <input 
                                type="text" 
                                id="student-search-input" 
                                placeholder=" ·â∞·àõ·à™ ·àµ·àù ·çà·àç·åç..." 
                                class="w-full px-4 py-3 pr-10 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200"
                                oninput="handleSearch(this.value)"
                            >
                            <button 
                                onclick="clearSearch()" 
                                class="absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600 transition"
                                id="clear-search-btn"
                                style="display: none;"
                            >
                                ‚úï
                            </button>
                        </div>
                        <div class="text-sm text-gray-500" id="search-results-count">
                            ${students.length} ·â∞·àõ·à™·ãé·âΩ
                        </div>
                    </div>
                </div>
            `;
            
            const existingSearch = document.getElementById('search-container');
            if (existingSearch) {
                existingSearch.remove();
            }
            
            const searchContainer = document.createElement('div');
            searchContainer.id = 'search-container';
            searchContainer.innerHTML = searchHTML;
            leaderboardContainer.parentNode.insertBefore(searchContainer, leaderboardContainer);
        }

        function handleSearch(query) {
            searchQuery = query.trim().toLowerCase();
            const clearSearchBtn = document.getElementById('clear-search-btn');
            
            if (searchQuery) {
                clearSearchBtn.style.display = 'block';
                isSearching = true;
            } else {
                clearSearchBtn.style.display = 'none';
                isSearching = false;
            }
            
            renderLeaderboard();
            updateSearchResultsCount();
        }

        function clearSearch() {
            const searchInput = document.getElementById('student-search-input');
            searchInput.value = '';
            searchQuery = '';
            isSearching = false;
            document.getElementById('clear-search-btn').style.display = 'none';
            renderLeaderboard();
            updateSearchResultsCount();
        }

        function filterStudents() {
            if (!searchQuery) return students;
            
            return students.filter(student => 
                student.name.toLowerCase().includes(searchQuery)
            );
        }

        function updateSearchResultsCount() {
            const resultsCountElement = document.getElementById('search-results-count');
            const filteredStudents = filterStudents();
            
            if (isSearching) {
                resultsCountElement.innerHTML = `
                    <span class="text-blue-600 font-semibold">${filteredStudents.length}</span> 
                    ·ä® <span class="font-semibold">${students.length}</span> ·â∞·àõ·à™·ãé·âΩ ·â∞·åà·äù·â∞·ãã·àç
                    ${searchQuery ? `·àà "<span class="text-blue-600">${searchQuery}</span>"` : ''}
                `;
            } else {
                resultsCountElement.textContent = `${students.length} ·â∞·àõ·à™·ãé·âΩ`;
            }
        }

        // Student Management
        function addMultipleStudents(studentList) {
            const newStudents = studentList.map(student => ({
                id: Date.now().toString() + Math.random(),
                name: student.name,
                gender: student.gender,
                scores: {},
                createdAt: new Date()
            }));
            
            students.push(...newStudents);
            saveToLocalStorage();
            renderLeaderboard();
        }

        function updateStudentMarks(studentId, newName, newScores) {
            const studentIndex = students.findIndex(s => s.id === studentId);
            if (studentIndex !== -1) {
                students[studentIndex].name = newName;
                students[studentIndex].scores = newScores;
                students[studentIndex].updatedAt = new Date();
                saveToLocalStorage();
                showMessage(`·ã®·â∞·àõ·à™ ${newName} ·ãç·å§·â∂·âΩ ·â†·â∞·à≥·ä´ ·àÅ·äî·â≥ ·â∞·àª·àΩ·àà·ãã·àç·ç¢`, 'success');
                renderLeaderboard();
            }
        }

        function deleteStudent(studentId) {
            students = students.filter(student => student.id !== studentId);
            saveToLocalStorage();
            showMessage("·â∞·àõ·à™ ·â†·â∞·à≥·ä´ ·àÅ·äî·â≥ ·â∞·à∞·à≠·ãü·àç·ç¢", 'success');
            renderLeaderboard();
        }

        function deleteAllStudents() {
            showConfirmationModal(
                `·ä•·à≠·åç·å†·äõ ·äê·àÖ ·àÅ·àâ·äï·àù ·â∞·àõ·à™·ãé·âΩ ·àõ·àµ·ãà·åà·ãµ ·âµ·çà·àç·åã·àà·àÖ? ·ã≠·àÖ ·ä•·à≠·àù·åÉ ·àä·àò·àà·àµ ·ä†·ã≠·âΩ·àç·àù·ç¢`,
                () => {
                    students = [];
                    saveToLocalStorage();
                    showMessage(`·àÅ·àâ·àù ·â∞·àõ·à™·ãé·âΩ ·â∞·à∞·à≠·ãò·ãã·àç·ç¢`, 'success');
                    renderLeaderboard();
                }
            );
        }

        // EDIT STUDENT MODAL FUNCTION
        function showEditStudentModal(studentId) {
            const student = students.find(s => s.id === studentId);
            if (!student) {
                showMessage("·â∞·àõ·à™ ·ä†·àç·â∞·åà·äò·àù·ç¢", 'error');
                return;
            }
            
            let formContent = `
                <form id="edit-student-form" class="space-y-4">
                    <div>
                        <label for="edit-student-name" class="block text-sm font-medium text-gray-700 mb-2">·ã®·â∞·àõ·à™ ·àµ·àù</label>
                        <input type="text" id="edit-student-name" value="${student.name}" required
                            class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 transition-all">
                    </div>
                    <div class="space-y-3 max-h-72 overflow-y-auto p-2 border rounded-lg bg-gray-50">
                        <h4 class="font-semibold text-gray-800 border-b pb-2 sticky top-0 bg-gray-50/90 z-10">·äê·å•·â¶·âΩ·äï ·ä†·à≠·âµ·ãï (0-100)</h4>
                        <div class="grid grid-cols-2 gap-x-4 gap-y-3">
            `;

            departments.forEach(dept => {
                const score = student.scores[dept.id] !== undefined ? student.scores[dept.id] : 0;
                formContent += `
                    <div class="col-span-1">
                        <label for="edit-score-${dept.id}" class="text-sm font-medium text-gray-500 truncate">${dept.name}</label>
                        <input type="number" id="edit-score-${dept.id}" name="${dept.id}" value="${score}" min="0" max="100"
                            class="w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-1 focus:ring-blue-500">
                    </div>
                `;
            });

            formContent += `
                        </div>
                    </div>
                    <input type="hidden" id="edit-student-id" value="${studentId}">
                </form>
            `;

            // Update modal content
            const modalTitle = document.getElementById('modal-title');
            const modalContent = document.getElementById('modal-content');
            const modalActions = document.getElementById('modal-actions');
            
            modalTitle.textContent = `·â∞·àõ·à™ ·ä†·à≠·âµ·ãï: ${student.name}`;
            modalContent.innerHTML = formContent;
            
            modalActions.innerHTML = `
                <button onclick="hideModal()" class="px-6 py-2 bg-gray-200 text-gray-700 font-semibold rounded-lg hover:bg-gray-300 transition border border-gray-300">
                    cancel
                </button>
                <button onclick="saveStudentEdit()" class="px-6 py-2 bg-green-600 text-white font-semibold rounded-lg hover:bg-green-700 transition border border-green-600">
                  save
                </button>
            `;

            // Show modal
            const modal = document.getElementById('confirmation-modal');
            modal.classList.remove('hidden');
        }

        // SAVE STUDENT EDIT FUNCTION
        function saveStudentEdit() {
            const studentId = document.getElementById('edit-student-id').value;
            const nameInput = document.getElementById('edit-student-name');
            
            if (!nameInput.value.trim()) {
                showMessage("·ã®·â∞·àõ·à™ ·àµ·àù ·â£·ã∂ ·àä·àÜ·äï ·ä†·ã≠·âΩ·àç·àù·ç¢", 'error');
                return;
            }

            const newName = nameInput.value.trim();
            const newScores = {};
            let isValid = true;

            departments.forEach(dept => {
                const input = document.getElementById(`edit-score-${dept.id}`);
                const score = input.value === '' ? 0 : parseInt(input.value);

                if (score < 0 || score > 100) {
                    showMessage(`·àà ${dept.name} ·ã®·àõ·ã≠·åà·â£ ·äê·å•·â•·ç¢ ·ä® 0 ·ä•·àµ·ä® 100 ·àò·àÜ·äï ·ä†·àà·â†·âµ·ç¢`, 'error');
                    isValid = false;
                }
                newScores[dept.id] = score;
            });

            if (isValid) {
                updateStudentMarks(studentId, newName, newScores);
                hideModal();
            }
        }

        // Leaderboard Functions - Updated for 3 statuses
        function calculateStatsAndRank(studentsToRank) {
            const studentsWithStats = studentsToRank.map(student => {
                let totalScore = 0;
                let hasAnyScore = false;
                let allZero = true;
                let validDepartmentCount = 0;

                departments.forEach(dept => {
                    const score = student.scores[dept.id] !== undefined ? student.scores[dept.id] : 0; 
                    totalScore += score;
                    validDepartmentCount++;
                    
                    if (score !== undefined && score > 0) {
                        hasAnyScore = true;
                        allZero = false;
                    }
                });

                const average = validDepartmentCount > 0 ? totalScore / validDepartmentCount : 0;
                
                // Determine status
                let status = 'not-study';
                let statusText = '·àù·äï·àù ·ä†·àç·â∞·àõ·à®·àù';
                let statusClass = 'bg-gray-100 text-gray-800 border-gray-200';
                
                if (hasAnyScore && !allZero) {
                    if (average >= 50) {
                        status = 'pass';
                        statusText = '·ã®·â∞·àõ·à®';
                        statusClass = 'bg-green-100 text-green-800 border-green-200';
                    } else {
                        status = 'fail';
                        statusText = '·ã´·àç·â∞·àõ·à®';
                        statusClass = 'bg-red-100 text-red-800 border-red-200';
                    }
                }
                
                return { 
                    ...student, 
                    average: average, 
                    totalScore: totalScore, 
                    status: status,
                    statusText: statusText,
                    statusClass: statusClass,
                    hasScores: hasAnyScore && !allZero
                };
            });

            // Sort only students who have scores
            const studentsWithScores = studentsWithStats.filter(s => s.hasScores);
            const studentsWithoutScores = studentsWithStats.filter(s => !s.hasScores);
            
            studentsWithScores.sort((a, b) => b.average - a.average);

            // Assign ranks to students with scores
            let currentRank = 1;
            for (let i = 0; i < studentsWithScores.length; i++) {
                const student = studentsWithScores[i];
                if (i > 0 && student.average < studentsWithScores[i - 1].average) {
                    currentRank = i + 1;
                }
                student.rank = currentRank;
            }

            // Combine back with students without scores
            const allStudents = [...studentsWithScores, ...studentsWithoutScores];
            
            // For students without scores, show "-" for rank
            studentsWithoutScores.forEach(student => {
                student.rank = '-';
            });

            return allStudents;
        }

        function renderLeaderboard() {
            const leaderboardContainer = document.getElementById('leaderboard-container');
            const filteredStudents = filterStudents();
            
            // Update Excel button
            const excelBtn = document.getElementById('excel-download-btn');
            if (excelBtn) {
                excelBtn.innerHTML = `Excel  (${filteredStudents.length} ·â∞·àõ·à™·ãé·âΩ)`;
            }

            if (departments.length === 0) {
                leaderboardContainer.innerHTML = `
                    <div class="text-center py-12 text-gray-600">
                        <div class="text-6xl mb-4"></div>
                        <p class="text-xl font-bold">·àù·äï·àù ·âµ·àù·àÖ·à≠·âµ ·ä†·àç·â∞·å®·àò·à®·àù!</p>
                        <p class="text-sm mt-2">·àà·àò·åÄ·àò·à≠ ·â†·äÆ·äï·çä·åç·à¨·àΩ·äï ·âµ·àù·àÖ·à≠·â∂·âΩ·äï ·ã´·ä≠·àâ·ç¢</p>
                    </div>
                `;
                return;
            }

            if (filteredStudents.length === 0) {
                if (isSearching) {
                    leaderboardContainer.innerHTML = `
                        <div class="text-center py-12 text-gray-500">
                            <div class="text-6xl mb-4"></div>
                            <p class="text-xl">·àù·äï·àù ·â∞·àõ·à™ ·ä†·àç·â∞·åà·äò·àù</p>
                            <p class="text-sm mt-2">"<span class="text-blue-600 font-semibold">${searchQuery}</span>" ·àà·àö·àà·ãç ·çç·àà·åã ·ãç·å§·âµ ·ä†·àç·â∞·åà·äò·àù</p>
                            <button onclick="clearSearch()" 
                                class="mt-4 bg-gray-600 text-white px-6 py-3 rounded-lg font-semibold hover:bg-gray-700 transition-all duration-200">
                                ·çç·àà·åã ·ä†·åΩ·ã≥
                            </button>
                        </div>
                    `;
                } else {
                    leaderboardContainer.innerHTML = `
                        <div class="text-center py-12 text-gray-500">
                            <div class="text-6xl mb-4"></div>
                            <p class="text-xl">·àù·äï·àù ·â∞·àõ·à™ ·ä†·àç·â∞·åà·äò·àù</p>
                            <p class="text-sm mt-2">·â∞·àõ·à™·ãé·âΩ ·â†·à´·àµ·à∞·à≠ ·â∞·å®·àù·à®·ãã·àç·ç¢ ·åà·åπ·äï ·ã≠·ãµ·åà·àô·âµ·ç¢</p>
                        </div>
                    `;
                }
                return;
            }

            const rankedStudents = calculateStatsAndRank(filteredStudents);
            
            // Generate header with gender icons
            let headerHtml = `<div class="text-center">#</div>
                              <div class="col-span-2 flex items-center">·àµ·àù</div>`;
            departments.forEach(dept => {
                headerHtml += `<div class="text-center truncate">${dept.name}</div>`;
            });
            headerHtml += `<div class="text-center">·å†·âÖ·àã·àã</div>
                           <div class="text-center">·ä†·àõ·ä´·ã≠</div>
                           <div class="text-center">·àÅ·äî·â≥</div>
                           <div class="text-center">·ã∞·à®·åÉ</div>
                           <div class="text-center">·ãµ·à≠·åä·â∂·âΩ</div>`;

            const gridTemplateColumns = `0.5fr 2.5fr ${'1fr '.repeat(departments.length)} 1fr 1fr 0.8fr 0.5fr 1fr`;

            let html = `
                <div style="grid-template-columns: ${gridTemplateColumns};" 
                     class="grid gap-4 px-4 py-3 text-sm font-semibold text-gray-700 border-b bg-gray-50">
                    ${headerHtml}
                </div>
            `;
            
            rankedStudents.forEach((student, index) => {
                const rankClass = student.rank === 1 ? 'rank-1' :
                                  student.rank === 2 ? 'rank-2' :
                                  student.rank === 3 ? 'rank-3' : 'bg-white hover:bg-gray-50';
                
                const medal = student.rank === 1 ? '1' :
                              student.rank === 2 ? '2' :
                              student.rank === 3 ? '3' : student.rank;

                // Highlight search term
                let highlightedName = student.name;
                if (searchQuery) {
                    const regex = new RegExp(`(${searchQuery})`, 'gi');
                    highlightedName = student.name.replace(regex, '<mark class="bg-yellow-200 px-1 rounded">$1</mark>');
                }

                // Gender icon
                const genderIcon = student.gender === 'female' ? 'üë©‚Äçüéì' : 'üë®‚Äçüéì';

                let scoreCells = '';
                departments.forEach(dept => {
                    const score = student.scores[dept.id] !== undefined ? student.scores[dept.id] : '-';
                    scoreCells += `<div class="text-center text-gray-700 font-medium">${score}${score !== '-' ? '%' : ''}</div>`;
                });

                html += `
                    <div style="grid-template-columns: ${gridTemplateColumns};" 
                         class="grid gap-4 px-4 py-3 items-center rounded-lg border ${rankClass} transform hover:scale-[1.01] transition-all duration-200">
                        <div class="col-span-1 text-center font-medium text-gray-500">${index + 1}</div>
                        <div class="col-span-2 font-semibold text-gray-800 truncate cursor-pointer hover:underline flex items-center gap-2" 
                             onclick="showEditStudentModal('${student.id}')"
                             title="·àà·àõ·à≠·âµ·ãï ·ã≠·å´·äë">
                            <span class="text-lg">${genderIcon}</span>
                            <span>${highlightedName}</span>
                        </div>
                        ${scoreCells}
                        <div class="text-center font-bold text-lg text-gray-800">${student.hasScores ? student.totalScore : '-'}</div>
                        <div class="text-center font-bold text-lg text-gray-800">${student.hasScores ? student.average.toFixed(1) + '%' : '-'}</div>
                        <div class="text-center">
                            <span class="px-2 py-1 text-xs font-semibold rounded-full border ${student.statusClass}">
                                ${student.statusText}
                            </span>
                        </div>
                        <div class="col-span-1 text-center font-bold text-lg">${medal}</div>
                        <div class="text-center">
                            <button onclick="showConfirmationModal('·ä•·à≠·åç·å†·äõ ·äê·àÖ ·â∞·àõ·à™ ${student.name} ·äï ·àò·ã∞·àà·âµ ·âµ·çà·àç·åã·àà·àÖ?', () => deleteStudent('${student.id}'))" class="text-gray-500 hover:text-red-600 transition">
                                delete
                            </button>
                        </div>
                    </div>
                `;
            });

            leaderboardContainer.innerHTML = html;
            updateSearchResultsCount();
            updateStudentStats();
        }

        // Configuration View
        function renderConfigView() {
            const configDepartmentsList = document.getElementById('config-departments-list');
            configDepartmentsList.innerHTML = ''; 

            if (departments.length === 0) {
                configDepartmentsList.innerHTML = `<div class="text-center py-6 text-gray-500">·ä•·àµ·ä´·àÅ·äï ·àù·äï·àù ·âµ·àù·àÖ·à≠·âµ ·ä†·àç·â∞·å®·àò·à®·àù·ç¢</div>`;
            }

            departments.forEach(dept => {
                const deptElement = document.createElement('div');
                deptElement.className = 'flex justify-between items-center bg-gray-50 p-4 rounded-lg border border-gray-200';
                deptElement.innerHTML = `
                    <div class="flex-grow">
                        <span id="dept-name-${dept.id}" class="text-lg font-semibold text-gray-800">${dept.name}</span>
                        <input type="text" id="dept-input-${dept.id}" value="${dept.name}" 
                            class="hidden w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" 
                            placeholder="·ä†·ã≤·àµ ·âµ·àù·àÖ·à≠·âµ ·àµ·àù">
                    </div>
                    <div id="dept-actions-${dept.id}" class="space-x-2 flex">
                        <button onclick="toggleEditMode('${dept.id}')" 
                            class="text-blue-600 hover:text-blue-800 px-3 py-1 rounded-lg transition font-medium border border-blue-200 hover:border-blue-300">
                            edit
                        </button>
                        <button onclick="showConfirmationModal('·âµ·àù·àÖ·à≠·âµ ${dept.name} ·äï ·àò·ã∞·àà·âµ ·âµ·çà·àç·åã·àà·àÖ?', () => deleteDepartment('${dept.id}'))" 
                            class="text-red-600 hover:text-red-800 px-3 py-1 rounded-lg transition font-medium border border-red-200 hover:border-red-300">
                            delete
                        </button>
                    </div>
                `;
                configDepartmentsList.appendChild(deptElement);
            });
        }

        function toggleEditMode(departmentId) {
            const nameDisplay = document.getElementById(`dept-name-${departmentId}`);
            const inputEdit = document.getElementById(`dept-input-${departmentId}`);
            const actionsContainer = document.getElementById(`dept-actions-${departmentId}`);

            const isEditing = nameDisplay.classList.contains('hidden');

            if (isEditing) {
                const newName = inputEdit.value.trim();
                if (newName && newName !== nameDisplay.textContent) {
                    editDepartment(departmentId, newName);
                }
                nameDisplay.classList.remove('hidden');
                inputEdit.classList.add('hidden');
                actionsContainer.innerHTML = `
                    <button onclick="toggleEditMode('${departmentId}')" class="text-blue-600 hover:text-blue-800 px-3 py-1 rounded-lg transition font-medium border border-blue-200 hover:border-blue-300">·ä†·à≠·âµ·ãï</button>
                    <button onclick="showConfirmationModal('·âµ·àù·àÖ·à≠·âµ ${nameDisplay.textContent} ·äï ·àò·ã∞·àà·âµ ·âµ·çà·àç·åã·àà·àÖ?', () => deleteDepartment('${departmentId}'))" class="text-red-600 hover:text-red-800 px-3 py-1 rounded-lg transition font-medium border border-red-200 hover:border-red-300">·à∞·à≠·ãù</button>
                `;
            } else {
                nameDisplay.classList.add('hidden');
                inputEdit.classList.remove('hidden');
                actionsContainer.innerHTML = `
                    <button onclick="toggleEditMode('${departmentId}')" class="bg-green-600 text-white px-3 py-1 rounded-lg transition font-medium hover:bg-green-700 border border-green-600">·ä†·àµ·âÄ·àù·å•</button>
                    <button onclick="toggleEditMode('${departmentId}')" class="text-gray-600 hover:text-gray-800 px-3 py-1 rounded-lg transition font-medium border border-gray-300 hover:border-gray-400">·ã≠·âÖ·à≠</button>
                `;
                inputEdit.focus();
            }
        }

        function editDepartment(departmentId, newName) {
            const departmentIndex = departments.findIndex(d => d.id === departmentId);
            if (departmentIndex !== -1) {
                departments[departmentIndex].name = newName;
                saveToLocalStorage();
                showMessage(`·âµ·àù·àÖ·à≠·âµ ·ãà·ã∞ "${newName}" ·â∞·àª·àΩ·àè·àç·ç¢`, 'success');
                renderConfigView();
                renderLeaderboard();
            }
        }

        function addDepartment(name) {
            if (departments.some(d => d.name.toLowerCase() === name.toLowerCase())) {
                showMessage("·ã≠·àÖ ·âµ·àù·àÖ·à≠·âµ ·ä†·àµ·âÄ·ãµ·àû ·ä†·àà!", 'error');
                return;
            }

            const newDepartment = {
                id: Date.now().toString(),
                name: name
            };
            
            departments.push(newDepartment);
            saveToLocalStorage();
            showMessage(`·âµ·àù·àÖ·à≠·âµ "${name}" ·â∞·å®·àù·àØ·àç!`, 'success');
            document.getElementById('new-department-name').value = '';
            renderConfigView();
            renderLeaderboard();
        }

        function deleteDepartment(departmentId) {
            const departmentIndex = departments.findIndex(d => d.id === departmentId);
            if (departmentIndex !== -1) {
                const departmentName = departments[departmentIndex].name;
                departments.splice(departmentIndex, 1);
                saveToLocalStorage();
                showMessage(`·âµ·àù·àÖ·à≠·âµ "${departmentName}" ·â∞·à∞·à≠·ãü·àç·ç¢`, 'success');
                renderConfigView();
                renderLeaderboard();
            }
        }

        // Excel Export
        function exportToExcel() {
            const filteredStudents = filterStudents();
            
            if (filteredStudents.length === 0) {
                showMessage("·àù·äï·àù ·ã®·â∞·àõ·à™ ·ãç·å§·âµ ·ã®·àà·àù·ç¢", 'error');
                return;
            }
            
            const rankedStudents = calculateStatsAndRank(filteredStudents);
            
            const excelData = [];
            
            // Headers
            const headers = ['·â∞.·âÅ', '·àµ·àù', '·åæ·â≥', ...departments.map(d => d.name), '·å†·âÖ·àã·àã ·äê·å•·â•', '·ä†·àõ·ä´·ã≠', '·àÅ·äî·â≥', '·ã∞·à®·åÉ'];
            excelData.push(headers);
            
            // Student data
            rankedStudents.forEach((student, index) => {
                const row = [
                    index + 1,
                    student.name,
                    student.gender === 'male' ? '·ãà·äï·ãµ' : '·à¥·âµ',
                    ...departments.map(dept => student.scores[dept.id] !== undefined ? student.scores[dept.id] : 0),
                    student.hasScores ? student.totalScore : 0,
                    student.hasScores ? student.average.toFixed(2) : 0,
                    student.statusText,
                    student.rank
                ];
                excelData.push(row);
            });
            
            const ws = XLSX.utils.aoa_to_sheet(excelData);
            const wb = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(wb, ws, `·â∞·àõ·à™·ãé·âΩ`);
            XLSX.writeFile(wb, `·ã®·â∞·àõ·à™_·ãç·å§·âµ_·àõ·àµ·ãà·å£·âµ.xlsx`);
            
            showMessage(`${rankedStudents.length} ·â∞·àõ·à™·ãé·âΩ ·â†·â∞·à≥·ä´ ·àÅ·äî·â≥ ·ãà·ã∞ Excel ·â∞·àã·ä©·ç¢`, 'success');
        }

        // UI Functions
        function showMessage(text, type = 'success') {
            const messageBox = document.getElementById('message-box');
            messageBox.textContent = text;
            messageBox.className = `p-3 rounded-xl mb-4 text-center font-medium shadow-md ${
                type === 'error' ? 'bg-red-100 text-red-700 border border-red-200' : 'bg-green-100 text-green-700 border border-green-200'
            }`;
            messageBox.style.display = 'block';
            setTimeout(() => {
                messageBox.style.display = 'none';
            }, 5000);
        }

        function showConfirmationModal(message, action) {
            const modal = document.getElementById('confirmation-modal');
            const modalContent = document.getElementById('modal-content');
            const modalActions = document.getElementById('modal-actions');
            
            modalContent.innerHTML = `<p class="text-gray-600 mb-6">${message}</p>`;
            modalActions.innerHTML = `
                <button onclick="hideModal()" class="px-6 py-2 bg-gray-200 text-gray-700 font-semibold rounded-lg hover:bg-gray-300 transition border border-gray-300">
                    ·ã≠·âÖ·à≠
                </button>
                <button onclick="confirmAction()" class="px-6 py-2 bg-red-600 text-white font-semibold rounded-lg hover:bg-red-700 transition border border-red-600">
                    ·ä†·à®·åã·åç·å•
                </button>
            `;
            
            window.confirmAction = function() {
                action();
                hideModal();
            };
            
            modal.classList.remove('hidden');
        }

        function hideModal() {
            const modal = document.getElementById('confirmation-modal');
            modal.classList.add('hidden');
        }

        function switchView(view) {
            const dashboardView = document.getElementById('dashboard-view');
            const configView = document.getElementById('config-view');
            const dashboardBtn = document.getElementById('dashboard-btn');
            const configBtn = document.getElementById('config-btn');
            
            if (view === 'config') {
                dashboardView.classList.add('hidden');
                configView.classList.remove('hidden');
                dashboardBtn.classList.remove('bg-blue-600', 'text-white');
                dashboardBtn.classList.add('bg-gray-200', 'text-gray-700');
                configBtn.classList.add('bg-blue-600', 'text-white');
                configBtn.classList.remove('bg-gray-200', 'text-gray-700');
                renderConfigView();
            } else {
                configView.classList.add('hidden');
                dashboardView.classList.remove('hidden');
                configBtn.classList.remove('bg-blue-600', 'text-white');
                configBtn.classList.add('bg-gray-200', 'text-gray-700');
                dashboardBtn.classList.add('bg-blue-600', 'text-white');
                dashboardBtn.classList.remove('bg-gray-200', 'text-gray-700');
                renderLeaderboard();
            }
        }

        // Event Listeners
        document.addEventListener('DOMContentLoaded', function() {
            initializeApp();
            
            // Add department form
            document.getElementById('add-department-form').addEventListener('submit', function(e) {
                e.preventDefault();
                const name = document.getElementById('new-department-name').value.trim();
                if (name) {
                    addDepartment(name);
                } else {
                    showMessage("·ã®·âµ·àù·àÖ·à≠·âµ ·àµ·àù ·â£·ã∂ ·àä·àÜ·äï ·ä†·ã≠·âΩ·àç·àù·ç¢", 'error');
                }
            });
        });

        // Global functions
        window.switchView = switchView;
        window.handleSearch = handleSearch;
        window.clearSearch = clearSearch;
        window.toggleEditMode = toggleEditMode;
        window.deleteAllStudents = deleteAllStudents;
        window.deleteStudent = deleteStudent;
        window.exportToExcel = exportToExcel;
        window.hideModal = hideModal;
        window.showConfirmationModal = showConfirmationModal;
        window.showEditStudentModal = showEditStudentModal;
        window.saveStudentEdit = saveStudentEdit;

    </script>
    <style>
        .rank-1 { background: linear-gradient(135deg, #fef3c7, #fef7cd); border: 2px solid #f59e0b; }
        .rank-2 { background: linear-gradient(135deg, #e5e7eb, #f3f4f6); border: 2px solid #6b7280; }
        .rank-3 { background: linear-gradient(135deg, #fcd34d, #fed7aa); border: 2px solid #d97706; }
        mark { background-color: #fef3c7; padding: 0 2px; border-radius: 2px; }
    </style>
</head>
<body class="min-h-screen py-8 bg-gray-50">
    <div class="max-w-7xl mx-auto px-4">
        <!-- Header -->
        <div class="text-center mb-6">
            <h1 class="text-4xl font-bold text-gray-800 mb-2">·ã® ·çà·àà·åà ·àÖ·ã≠·ãà·âµ ·à∞·äï·â†·âµ ·âµ·àù·à≠·âµ ·â§·âµ</h1>
            <p class="text-gray-600 mb-4">·ã® ·â∞·àõ·à™ ·àõ·à≠·ä≠ ·àò·àô·ã´</p>

            <!-- Navigation -->
            <div class="inline-flex rounded-lg bg-gray-100 p-1 border border-gray-200">
                <button id="dashboard-btn" onclick="switchView('dashboard')"
                    class="px-6 py-2 rounded-lg font-semibold transition-all duration-300 bg-blue-600 text-white">
                    üìä Home
                </button>
                <button id="config-btn" onclick="switchView('config')"
                    class="px-6 py-2 rounded-lg font-semibold transition-all duration-300 bg-gray-200 text-gray-700 hover:bg-gray-300">
                    ‚öôÔ∏è Setting
                </button>
            </div>
        </div>
        
        <!-- Message Box -->
        <div id="message-box" style="display: none;" class="max-w-4xl mx-auto"></div>

        <!-- Main Dashboard -->
        <div id="dashboard-view">
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                <!-- Left Column - Student Information -->
                <div class="space-y-8">
                    <!-- Student Stats Card -->
                    <div class="bg-white rounded-xl p-6 shadow-sm border border-gray-200">
                        <h2 class="text-2xl font-bold text-gray-800 mb-4">·ã®·â∞·àõ·à™ ·àò·à®·åÉ</h2>
                        <div id="student-stats-container">
                            <!-- Stats will be loaded here -->
                        </div>
                    </div>

                    <!-- Delete All -->
                    <div class="bg-white rounded-xl p-6 shadow-sm border border-gray-200">
                        <button onclick="deleteAllStudents()" class="w-full bg-red-600 text-white py-4 rounded-lg font-semibold hover:bg-red-700 transition-all">
                            ·ã®·â∞·àõ·à™ ·ãù·à≠·ãù·à≠ ·àà·àõ·å•·çã·âµ
                        </button>
                    </div>
                </div>

                <!-- Right Column -->
                <div class="lg:col-span-2">
                    <div class="bg-white rounded-xl p-6 shadow-sm border border-gray-200">
                        <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center mb-6">
                            <h2 class="text-2xl font-bold text-gray-800 mb-4 sm:mb-0">·àõ·à≠·ä≠ ·àä·àµ·âµ</h2>
                            <button id="excel-download-btn" onclick="exportToExcel()" class="bg-green-600 text-white px-4 py-2 rounded-full font-semibold hover:bg-green-700 transition-all">
                                üì• Excel
                            </button>
                        </div>

                        <!-- Search will be inserted here -->
                        <div id="leaderboard-container">
                            <!-- Leaderboard content -->
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Configuration View -->
        <div id="config-view" class="hidden">
            <div class="bg-white rounded-xl p-8 shadow-sm border border-gray-200">
                <h2 class="text-3xl font-bold text-gray-800 mb-6">·âµ·àù·à≠·âµ ·àò·å®·àò·à≠·ã´</h2>
                
                <!-- Add Department -->
                <div class="mb-8 p-5 border border-dashed border-gray-300 rounded-lg bg-gray-50">
                    <h3 class="text-xl font-semibold mb-3 text-gray-700">·âµ·àù·à≠·âµ ·àà·àò·å®·àò·à≠</h3>
                    <form id="add-department-form" class="flex flex-col sm:flex-row space-y-3 sm:space-y-0 sm:space-x-4">
                        <input type="text" id="new-department-name" required class="flex-grow px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500" placeholder="·ã®·âµ·àù·àÖ·à≠·âµ ·àµ·àù">
                        <button type="submit" class="bg-blue-600 text-white py-3 px-6 rounded-lg font-semibold hover:bg-blue-700 transition-all">
                            ·å®·àù·à≠
                        </button>
                    </form>
                </div>

                <!-- Department List -->
                <h3 class="text-xl font-semibold mb-4 text-gray-700">·ã´·àâ ·âµ·àù·à≠·âµ·â∂·âΩ</h3>
                <div id="config-departments-list" class="space-y-3">
                    <!-- Departments will be listed here -->
                </div>
            </div>
        </div>
    </div>
    
    <!-- Confirmation Modal -->
    <div id="confirmation-modal" class="hidden fixed inset-0 z-50 bg-black bg-opacity-50 flex items-center justify-center">
        <div class="bg-white rounded-xl p-6 w-11/12 max-w-md shadow-lg border border-gray-200">
            <h3 id="modal-title" class="text-2xl font-bold text-gray-800 mb-4"></h3>
            <div id="modal-content" class="mb-6"></div>
            <div id="modal-actions" class="flex justify-end space-x-4"></div>
        </div>
</body>
</html>